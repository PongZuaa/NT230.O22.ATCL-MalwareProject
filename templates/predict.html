<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0" /> -->
    <link rel="stylesheet" type="text/css" href="/static/css/predict.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='css/predict.css') }}"
    />
    <title>Kết quả dự đoán</title>
  </head>
  <body>
    <div class="container">
      <h1>Kết quả dự đoán</h1>
      <div class="res_container">
        <div class="result">
          <div class="cnn res">
            <div class="pie animate" style="--p: 90">90%</div>
            <p>Convolutional Neural Network</p>
          </div>
          <div class="gin res">
            <div class="pie animate" style="--p: 35">35%</div>
            <p>Graph Isomorphism Network</p>
          </div>
          <div class="multi res">
            <div class="pie animate" style="--p: 50">50%</div>
            <p>Multimodel</p>
          </div>
        </div>
      </div>
      <div class="download">
        <a href="/download/csv">Tải về File CSV</a>
        <a href="/download/graph">Tải về File Đồ thị</a>
      </div>
    </div>
    <div class="conclusion container" id="conclusion">
      <div class="resultMessage" id="resultMessage"></div>
      <img id="resultImage" class="resultImage" src="" alt="" />
    </div>
    <script>
      function updatePieColorsAndMessage() {
        const pies = document.querySelectorAll(".pie");
        thres = 50;
        range = 10;
        left_limit = thres - range / 2;
        right_limit = thres + range / 2;
        pies.forEach((pie) => {
          const pValue = parseFloat(pie.style.getPropertyValue("--p"));
          let color;
          let message;
          let imageUrl;
          if (pValue < left_limit) {
            color = "red";
            message = "Phát hiện mã độc trong file của bạn";
            imageUrl = "../static/img/malware.png";
          } else if (pValue > 60) {
            color = "green";
            message = "File của bạn an toàn";
            imageUrl = "../static/img/benign.png";
          } else {
            color = "gold";
            message = "File của bạn có dấu hiệu đáng ngờ";
            imageUrl = "../static/img/suspicious.png";
          }
          pie.style.setProperty("--c", color);

          // Update the message and image for each pie chart
          const resultMessage = document.getElementById("resultMessage");
          const resultImage = document.getElementById("resultImage");
          resultMessage.textContent = message;
          resultImage.src = imageUrl;
          resultImage.alt = message;
        });
      }
      updatePieColorsAndMessage();
    </script>
  </body>
</html>
