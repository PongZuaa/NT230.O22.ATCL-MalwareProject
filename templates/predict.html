<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" type="text/css" href="../static/css/predict.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='css/predict.css') }}"
    />
    <title>Kết quả dự đoán</title>
  </head>
  <body>
    <div class="container">
      <h1>Kết quả dự đoán</h1>
      <div class="res_container">
        <div class="result">
          <div class="cnn res">
            <p>Convolutional Neural Network</p>
            <img class="resultImage" src="" alt="" />
            <p class="res_con">{{ cnn_prediction }}</p>
          </div>
          <div class="gin res">
            <p>Graph Isomorphism Network</p>
            <img class="resultImage" src="" alt="" />
            <p class="res_con">{{ gin_prediction }}</p>
          </div>
          <div class="multi res">
            <p>Multimodel</p>
            <img class="resultImage" src="" alt="" />
            <p class="res_con">{{ combined_prediction }}</p>
          </div>
        </div>
      </div>
      <h2 class="diff">{{ combined_prediction_diff }}</h2>
      <div class="download">
        <a href="/download/csv">Tải về File CSV</a>
        <a href="/download/graph">Tải về File Đồ thị</a>
      </div>
    </div>
    <div class="conclusion container" id="conclusion">
      <h2 class="resultMessage" id="resultMessage">
        {{ combined_prediction }}
      </h2>
      <img class="conclusionImage" src="" alt="" />
    </div>
    <script>
      function showResult() {
        const resultContainers = document.querySelectorAll(".res");
        resultContainers.forEach((container) => {
          const resCon = container.querySelector(".res_con");
          const resultImage = container.querySelector(".resultImage");
          const prediction = resCon.textContent.trim();

          if (prediction === "Malware") {
            resCon.style.color = "red";
            resultImage.src = "../static/img/malware.png";
            resultImage.alt = "Malware Image";
          } else {
            resCon.style.color = "green";
            resultImage.src = "../static/img/benign.png";
            resultImage.alt = "Benign Image";
          }
        });

        const resultMessage = document.querySelector(".diff");
        const message = resultMessage.textContent.trim();
        if (message === "Dự đoán trùng với dự đoán User") {
          resultMessage.textContent = "Kết quả trùng với dự đoán của bạn.";
        } else {
          resultMessage.textContent = "Kết quả khác với dự đoán của bạn.";
        }

        const conclusionMessage = document.querySelector(".resultMessage");
        const conclusionPrediction = conclusionMessage.textContent.trim();
        const conclusionImage = document.querySelector(".conclusionImage");
        if (conclusionPrediction === "Malware") {
          conclusionMessage.style.color = "red";
          conclusionMessage.textContent = "Phát hiện mã độc trong file của bạn.";
          conclusionImage.src = "../static/img/malware.png";
          conclusionImage.alt = "Malware";
        } else {
          conclusionMessage.style.color = "green";
          conclusionMessage.textContent = "File của bạn an toàn.";
          conclusionImage.src = "../static/img/benign.png";
          conclusionImage.alt = "Benign";
        } 
      }

      document.addEventListener("DOMContentLoaded", showResult);
    </script>
  </body>
</html>
